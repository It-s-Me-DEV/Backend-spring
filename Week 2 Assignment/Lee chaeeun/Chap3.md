# 3.1 스프링 부트 3 구조 살펴보기
스프링 부트는 각 계층이 양 옆의 계층과 통신하는 구조를 따른다. 

각 계층은 서로 소통할 수는 있지만 다른 계층에 직접 간섭하거나 영향을 미치지 않는다.

 

예를 들어, 어떤 거리에 카페와 빵집이 있다.

카페는 커피를, 빵집은 빵을 판다. 

그런데 필요한 경우 협업 관계를 맺어 어떤 손님이 커피를 사면 빵을 할인해줄 수도 있다.

 

이것이 계층 간의 소통이다. 

 

하지만 빵집 알바생이 빵을 팔다 말고 카페에 가서 커피를 팔 수는 없다.

 

즉, 계층은 서로 간의 영향은 끼치지 못한다는 점이다. 

 

스프링 부트에는 프레젠테이션, 비즈니스, 퍼시스턴스 계층이 있다.

## 프레젠테이션 계층
 

HTTP 요청을 받고 이 요청을 비즈니스 계층으로 전송하는 역할을 한다. 

컨트롤러가 바로 프레젠테이션 계층 역할을 한다.

컨트롤러는 스프링 부트 내에 여러 개가 있을 수 있다. 

 

## 비즈니스 계층
 

서비스를 만들기 위한 모든 로직인 비즈니스 로직을 처리한다. 

예를 들어 주문 서비스가 있다고 한다면, 

주문 개수, 가격 등 데이터를 처리하기 위한 로직, 주문 처리를 하다가 발생하는 예외 처리 로직, 주문을 받거나 취소하는 것 같이 프로세스를 구현하기 위한 로직이 이에 포함 된다.

 

서비스가 비즈니스 계층의 역할을 한다. 

 

## 퍼시스턴스 계층
 

모든 데이터베이스 관련 로직을 처리한다. 

이 과정에서 데이터베이스에 접근하는 DAO 객체를 사용할 수도 있다. 

 

DAO란, 데이터베이스와 상호작용하기 위한 객체이다.

 

리포지터리가 퍼시스턴스 계층 역할을 한다.

 
### main
 

실제 코드를 작성하는 공간으로 프로젝트 실행에 필요한 소스 코드와 리소스 파일이 들어있다.

 

### test

 

프로젝트의 소스 코드를 테스트할 목적의 코드와 리소스 파일이 들어있다.

 

### build.gradle

 

빌드를 설정하는 파일로 의존성이나 플러그인 설정과 같이 빌드에 필요한 설정을 할 때 사용한다.

 

### settings.gradle

 

빌드할 프로젝트의 정보를 설정하는 파일이다.

 

### main 디렉터리 구성하기
main 디렉토리는 java, resources로 구성되어 있다.

 

main/resources/static

-> static 디렉터리는 JS, CSS, 이미지와 같은 정적 파일을 넣는 용도이다.

 

포스트맨에서 데이터를 보기까지 아래와 같은 과정을 거친다.

 

HTTP 요청

------------->    TestController.java(프레젠테이션 계층)   <-->  TestService.java(서비스 계층)

url: / test

 

<-->Member.Repository.java(퍼시스턴스 계층) <----> 데이터베이스 

 
### 스프링 부트 요청-응답 과정 이해하기
 

1. 포스트맨에서 톰캣에 /test GET 요청을 한다. 이 요청은 스프링 부트 내로 이동한다.

2. 스프링 부트의 디스패처 서블릿이 URL을 분석하고, 이 요청을 처리할 수 있는 컨트롤러를 찾는다.

3. TestController가 /test라는 패스에 대한 GET 요청을 처리할 수 있는 getAllMembers() 메서드를 가지고 있으므로 디스패처 서블릿은 TestController에게 /test GET 요청을 전달한다. (마침내 /test GET 요청을 처리할 수 있는 getAllMembers()메서드와 이 요청이 매치된다!!)

4. getAllMembers() 메서드에서는 비즈니스 계층과 퍼시스턴스 계층을 통하면서 필요한 데이터를 가져온다.

5. 뷰 리졸버는 템플릿 엔진을 사용해 HTML 문서를 만들거나 JSON, XML 등의 데이터를 생성한다.

6. 그 결과 members를 return 하고 그 데이터를 포스트맨에서 볼 수 있게 된다. ( 클라이언트에게 반환 ) 

 

 
