# 데이터베이스 관리자, DBMS
데이터베이스는 많은 사람이 공유할 수 있어야 하므로 동시 접근을 할 수 있어야 한다.

: DBMS는 이런 요구사항을 만족하며 효율적으로 데이터베이스를 관리 & 운영

## 관계형 DBMS(=RDBMS)
RDBMS는 간단하게 테이블 형태로 이루어진 데이터 저장소라고 생각하면 쉽다.
### H2, MySQL
H2: 자바로 작성되어 있는 RDBMS

- 데이터를 다른 공간에 따로 보관하는 것이 아니라 애플리케이션 자체 내부에 데이터를 저장한다.

(애플리케이션을 다시 실행하면 데이터는 초기화된다.)  -> 개발 시 테스트 용도로 많이 사용, 실제 서비스X

 

MySQL: 실제 서비스에서 자주 사용된다.

# ORM( Object-relational mapping )이란?
ORM은 자바의 객체와 데이터베이스를 연결하는 프로그래밍 기법이다. 
ORM이 있다면 데이터베이스의 값을 마치 객체처럼 사용할 수 있다.

쉽게 말해 SQL을 전혀 몰라도 자바 언어로만 데이터베이스에 접근해서 원하는 데이터를 받아올 수 있다.

 

즉, 객체와 데이터베이스를 연결해 자바 언어로만 데이터베이스를 다룰 수 있게 하는 도구를 ORM이라고 한다.

##  ORM의 장점과 단점
장점 1. SQL을 직접 작성하지 않고 사용하는 언어로 데이터베이스에 접근할 수 있다.
장점 2. 객체지향적으로 코드를 작성할 수 있기 때문에 비즈니스 로직에만 집중할 수 있다.
장점 3. 데이터베이스 시스템이 추상화되어 있기 때문에 MySQL에서 PostgreSQL로 전환한다고 해서 추가로 드는 작업이 거의 없다. 즉, 데이터베이스 시스템에 대한 종속성이 줄어든다.
장점 4. 매핑하는 정보가 명확하기 때문에 ERD에 대한 의존도를 낯출 수 있고 유지보수 할 때 유리하다.
단점 1. 프로젝트의 복잡성이 커질수록 사용 난이도가 올라간다.
단점 2. 복잡하고 무거운 쿼리는 ORM으로 해결이 불가능한 경우가 많다. 

# JPA와 하이버네이트?
JPA는 자바에서 관계형 데이터베이스를 사용하는 방식을 정의한 인터페이스이다. 
-> 자바 객체와 데이터베이스를 연결해 데이터를 관리하며 객체 지향 도메인 모델과 데이터베이스의 다리 역할을 한다.


하이버네이트는 JPA 인터페이스를 구현한 구현체이자 자바용 ORM 프레임워크이다.
내부적으로는 JDBC API를 사용한다.


# 엔티티(entity): 엔티티는 데이터베이스의 테이블과 매핑되는 객체를 의미한다.

# 엔티티 매니저(entity manager): 엔티티 매니저는 엔티티를 관리해 데이터베이스와 애플리케이션 사이에서 객체를 생성, 수정, 삭제하는 등의 역할을 한다. 엔티티 매니저를 만드는 곳이 엔티티 매니저 팩토리(entity manager factory)이다. 

스프링 부트는 내부에서 엔티티 매니저 팩토리를 하나만 생성해서 관리하고 @PersistenceContext 또는 @Autowired 애너테이션을 사용해 엔티티 매니저를 사용한다. 

# 영속성 컨텍스트란?
영속성 컨텍스트는 JPA의 중요한 특징 중 하나로, 엔티티를 관리하는 가상의 공간이다.

## 영속성 컨텍스트의 기본적인 특징
1차 캐시: 영속성 컨텍스트는 내부에 1차 캐시를 가지고 있어 데이터를 조회할 때 데이터베이스를 거치지 않아도 매우 빠르게 데이터를 조회할 수 있다.

쓰기 지연: 랜잭션을 커밋하기 전까지는 데이터베이스에 실제로 질의문을 보내지 않고 쿼리를 모았다가 트랜잭션을 커밋하면 모았던 쿼리를 한번에 실행하는 것을 말한다.

변경 감지: 트랜잭션을 커밋하면 1차 캐시에 저장되어 있는 엔티티의 값과 현재 엔티티의 값을 비교해서 변경된 값이 있다면 변경 사항을 감지해 변경된 값을 데이터베이스에 자동으로 반영한다.

지연 로딩: 지연 로딩은 쿼리로 요청한 데이터를 애플리케이션에서 바로 로딩하는 것이 아니라 필요할 때 쿼리를 날려 데이터를 조회하는 것을 말한다.

## 엔티티의 상태
1. 영속성 컨텍스트가 관리하고 있지 않는 분리(detached) 상태

2. 영속성 컨텍스트가 관리하는 관리(managed) 상태

3. 영속성 컨텍스트와 전혀 관계가 없는 비영속(transient) 상태

4. 삭제된(removed) 상태

* 처음 엔티티를 만들면 비영속 상태가 된다.

# 스프링 데이터 JPA란?: 
스프링 데이터 JPA는 스프링 데이터의 공통적인 기능에서 JPA의 유용한 기술이 추가된 기술이다.

예를 들어, 데이터를 조회,삽입,수정,삭제하는 작업을 간단한 인터페이스로 처리할 수 있다.
일반적으로 반복되는 CRUD 코드를 거의 작성할 필요가 없다는 것이 큰 장점이다. 

''' 
public interface MemberRepository extends JpaRepositoty<Member,Long> {
}
'''

 




 
