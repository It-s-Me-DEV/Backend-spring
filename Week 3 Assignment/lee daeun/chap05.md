## Chap05. 데이터베이스 조작이 편해지는 ORM

**핵심 키워드** : DBMS, ORM, JPA, 하이버네이트, 엔티티, 영속성 컨텍스트, 스프링 데이터 JPA

### 데이터베이스란?
: 데이터를 매우 효율적으로 보관하고 꺼낼 수 있는 곳으로 많은 사람들이 안전하게 데이터를 사용하고 관리할 수 있다.

### DBMS란?
: 데이터베이스를 관리하기 위한 소프트웨어로 많은 사람이 공유할 수 있어야 하므로 동시 접근을 할 수 있어야 한다.
데이터베으스이 종류에는 관계형, 객체-관계형, 도큐먼트형, 비관계형이 있다.
1). H2 관계형 데이터베이스: 스프링 부트가 지원하는 인메모리 관계형 데이터베이스
2). MySQL 관계형 데이터베이스: 실제 서비스에서 사용하는 관계형 데이터베이스

### 데이터베이스 용어
> 테이블
: 데이터를 구성하기 위한 가장 기본적인 단위

> 행
: 테이블의 구성 요소 중 하나이며 테이블의 가로로 배열된 데이터의 집합

> 열
: 행에 저장되는 유형의 데이터

> 기본키
: 행을 구분할 수 있는 식별자로 테이블에서 유일해야하며 중복값을 가질 수 없다

> 쿼리
: 데이터베이스에서 데이터를 조회하거나 삭제, 생성, 수정을 하기 위해 사용

### SQL문으로 데이터베이스 조작
> SELECT: 테이블에 저장한 데이터를 조회

> WHERE: 조건을 넣어서 테이블을 조회

> INSERT: 테이블에 새로운 행을 추가하고 싶을 때

> DELETE: 테이블에 행을 삭제하고 싶을 때

> UPDATE: 특정 레코드의 값을 바꾸고 싶을 때

### ORM이란?
: 자바의 객체와 데이터베이스를 연결하는 프로그래밍 기법으로 ORM을 통해 데이터베이스의 값을 마치 객체처럼 사용한다.

### JPA와 하이버네이트
: 자바에서는 JPA를 표준으로 사용하는데, JPA란 자바에서 관계형 데이터베이스를 사용하는 방식을 정의한 인터페이스이다. 실제 사용을 위해서는 ORM 프레임워크를 추가로 선택해야한다.
이때 가장 대표적인 것은 하이버네이트이다. 하이버네이트의 목표는 데이터베이스를 자유자재로 사용할 수 있게 하는 데 있다.

### 엔티티 매니저란?
> 엔티티: 데이터베이스의 테이블과 매핑이되는 객체로 데이터베이스 테이블과 직접 연결된다는 특별한 특징이 있다. 즉 객체이긴 하지만 데이터베이스에 영향을 미치는 쿼리를 실행하는 객체이다.

> 엔티티 매니저: 엔터티를 관리해 데이터베이스와 애플리케이션 사이에서 객체를 생성, 수정, 삭제하는 역할

### 영속성 컨텍스트란?
: JPA의 중요한 특징 중 하나로, 엔티티를 관리하는 가상의 공간이다.

> 1차 캐시: 캐시의 키는 엔티티의 @ID 애너테이션이 달린 기본키 역할을 하는 식별자이며 값은 엔티티이다. 엔티티를 조회하면 1차 캐시에서 데이터를 조회하고 값을 반환한다.
> 값이 없다면 데이터베이스에서 조회한 후 1차 캐시에 저장한 후 반환한다.

> 쓰기 지연: 트랙잭션을 커밋하기 전까지 쿼리를 모았다가 한번에 실행

> 변경 감지: 커밋하면 1차 캐시와 현재 엔티티를 비교해 변경 사항을 감시한 후 변경값을 데이터베이스에 자동으로 반영한다.

> 지연 로딩: 쿼리로 요청한 데이터를 필요할 때 쿼리를 날려 데이터를 조회하는 것

** 데이터베이스의 접근을 최소화해 성능을 높일 수 있다**

### 엔티티의 상태
1). 분리 상태 ex). em.detach(member)
2). 관리 상태 ex). em.persist(member)
3). 비영속 상태 ex). Member member = new Member(1L, "홍길동")
4). 삭제된 상태 ex). em.remove(memver)

### 스프링 데이터
스프링 데이터: 비즈니스 로직에 더 집중할 수 있게 데이터베이스 사용 기능을 클래스 레벨에서 추상화한 것

### 스프링 데이터 JPA란?
: 스프링 데이터의 공통적인 기능에서 JPA의 유용한 기술이 추가된 기술이다. JPA를 더 편리하게 사용하는 메서드를 제공한다. 
=> 데이터베이스의 테이블 조회, 수정, 생성, 삭제와 같은 작업을 간단하게 할 수 있따.











